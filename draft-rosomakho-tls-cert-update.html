<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Certificate Update in TLS 1.3</title>
<meta content="Yaroslav Rosomakho" name="author">
<meta content="Tirumaleswar Reddy" name="author">
<meta content="
       This document defines a mechanism that enables TLS 1.3 endpoints to update their certificates during the lifetime of a connection using Exported Authenticators. A new extension is introduced to negotiate support for certificate update at handshake time. When negotiated, either endpoint can provide a post-handshake authenticator containing an updated certificate, delivered via a new handshake message. This mechanism allows long-lived TLS connections to remain valid across certificate rotations without requiring session termination. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="draft-rosomakho-tls-cert-update-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.10
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-rosomakho-tls-cert-update.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Certificate Update in TLS 1.3</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Rosomakho &amp; Reddy</td>
<td class="center">Expires 17 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Transport Layer Security</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-rosomakho-tls-cert-update-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-15" class="published">15 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-17">17 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Rosomakho</div>
<div class="org">Zscaler</div>
</div>
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">Nokia</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Certificate Update in TLS 1.3</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a mechanism that enables TLS 1.3 endpoints to update their certificates during the lifetime of a connection using Exported Authenticators. A new extension is introduced to negotiate support for certificate update at handshake time. When negotiated, either endpoint can provide a post-handshake authenticator containing an updated certificate, delivered via a new handshake message. This mechanism allows long-lived TLS connections to remain valid across certificate rotations without requiring session termination.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://yaroslavros.github.io/draft-tls-cert-refresh/draft-rosomakho-tls-cert-update.html">https://yaroslavros.github.io/draft-tls-cert-refresh/draft-rosomakho-tls-cert-update.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-rosomakho-tls-cert-update/">https://datatracker.ietf.org/doc/draft-rosomakho-tls-cert-update/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Transport Layer Security  mailing list (<span><a href="mailto:tls@ietf.org">mailto:tls@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tls/">https://mailarchive.ietf.org/arch/browse/tls/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tls/">https://www.ietf.org/mailman/listinfo/tls/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/yaroslavros/draft-tls-cert-refresh">https://github.com/yaroslavros/draft-tls-cert-refresh</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 17 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-negotiating-support-and-pro" class="internal xref">Negotiating Support and Providing Initial Authenticator Request</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-the-certificate_update_requ" class="internal xref">The certificate_update_request Extension</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-handling-malformed-extensio" class="internal xref">Handling Malformed Extension Data</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-certificate-update" class="internal xref">Certificate Update</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-requirements-for-authentica" class="internal xref">Requirements for Authenticators</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-sending-and-receiving-certi" class="internal xref">Sending and Receiving Certificate Updates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-additional-authenticator-re" class="internal xref">Additional Authenticator Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-sending-and-receiving-certif" class="internal xref">Sending and Receiving CertificateUpdateRequest</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-applicability-to-quic" class="internal xref">Applicability to QUIC</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-applicability-to-dtls" class="internal xref">Applicability to DTLS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-identity-continuity" class="internal xref">Identity Continuity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-replay-prevention" class="internal xref">Replay Prevention</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-application-layer-implicati" class="internal xref">Application-Layer Implications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-tls-extension" class="internal xref">TLS Extension</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-tls-handshake-message-types" class="internal xref">TLS Handshake Message Types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span>[<a href="#TLS" class="cite xref">TLS</a>]</span> provides strong guarantees of confidentiality, integrity, and authentication, but does not include a general-purpose mechanism for updating certificates of both endpoints after the handshake. While TLS 1.3 permits post-handshake authentication for clients as defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.6.2" class="relref">Section 4.6.2</a> of [<a href="#TLS" class="cite xref">TLS</a>]</span>, it provides no standardized way for servers to update their certificates once the handshake is complete. Additionally, TLS 1.3 post-handshake authentication is explicitly prohibited from QUIC according to <span><a href="https://rfc-editor.org/rfc/rfc9001#section-4.4" class="relref">Section 4.4</a> of [<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span> and HTTP/2 according to <span><a href="https://rfc-editor.org/rfc/rfc8740#section-2" class="relref">Section 2</a> of [<a href="#HTTP2-TLS13" class="cite xref">HTTP2-TLS13</a>]</span> because it allows clients to introduce new certificates and change authorization properties of the connection.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This presents a limitation for long-lived connections in environments where certificates may need to be refreshed, whether due to expiration, revocation, or key rotation. Terminating and re-establishing connections solely for the purpose of updating certificates can be disruptive and inefficient.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Exported Authenticators <span>[<a href="#EXPORTED-AUTH" class="cite xref">EXPORTED-AUTH</a>]</span> offer a general-purpose mechanism for proving possession of a certificate after the handshake, using an authenticator request supplied by the peer. However, the specification does not define a mechanism for transmitting authenticator requests or delivering authenticators at the TLS layer.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document defines a mechanism for certificate updates within an established TLS 1.3 connection. It introduces a new extension, <code>certificate_update_request</code>, that allows each endpoint to optionally include an authenticator request as part of the initial handshake. This request can later be used by the peer to generate an Exported Authenticator containing an update certificate.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">To deliver the updated certificate, a new TLS handshake message, <code>CertificateUpdate</code>, is defined. This message carries a complete Exported Authenticator and may be sent by either endpoint after the handshake, as long as an authenticator request was previously provided by the peer.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Because authenticator requests are single-use and may not be reused in subsequent authenticator constructions, a second post-handshake message is defined: <code>CertificateUpdateRequest</code>. This message allows an endpoint to provide a new authenticator request for future use after processing a <code>CertificateUpdate</code>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This approach allows TLS connections to remain valid across certificate updates without requiring session termination. It is compatible with TLS 1.3 and <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span>, and can be used regardless of the application protocol encapsulated within the connection.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">The certificate update mechanism in the document is deliberately constrained to preserve the authentication and authorization context of the connection. The updated certificate must retain the same subject, attributes, and issuing certificate authority as the original, with the only permitted difference being the validity period. This ensures that the peer identity remains unchanged and that application-layer authorization decisions based on the original certificate continue to hold after the update. By limiting the scope of updates in this way, the mechanism provides secure and seamless certificate refresh without altering the security properties of the TLS session.<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="negotiating-support-and-providing-initial-authenticator-request">
<section id="section-3">
      <h2 id="name-negotiating-support-and-pro">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-negotiating-support-and-pro" class="section-name selfRef">Negotiating Support and Providing Initial Authenticator Request</a>
      </h2>
<p id="section-3-1">To enable certificate updates, endpoints must explicitly indicate support during the TLS 1.3 handshake. This is done using the <code>certificate_update_request</code> extension, which may be included in either the ClientHello or EncryptedExtensions message.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The presence of this extension indicates that the sender supports the certificate update mechanism defined in this document. Optionally, the extension <span class="bcp14">MAY</span> carry an authenticator request. If present, this request can be used by the peer to construct an exported authenticator for delivery in a <code>CertificateUpdate</code> handshake message.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The extension <span class="bcp14">MAY</span> also be included with an empty "extension_data" field, which indicates support for the mechanism without offering an authenticator request.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="the-certificateupdaterequest-extension">
<section id="section-3.1">
        <h3 id="name-the-certificate_update_requ">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-the-certificate_update_requ" class="section-name selfRef">The certificate_update_request Extension</a>
        </h3>
<p id="section-3.1-1">The <code>certificate_update_request</code> extension is used to negotiate support for post-handshake certificate updates. It <span class="bcp14">MAY</span> appear in the <code>ClientHello</code> and in the <code>EncryptedExtensions</code> message.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The extension <span class="bcp14">MUST NOT</span> appear more than once from the same endpoint during a handshake. If it appears multiple times or in an unexpected message, the receiving peer <span class="bcp14">MUST</span> abort the handshake with an <code>illegal_parameter</code> alert.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">
            <p id="section-3.1-3.1.1">When sent in a <code>ClientHello</code>, the "extension_data" field, <span class="bcp14">MUST</span> be empty or contain a <code>CertificateRequest</code> structure as defined in <span><a href="https://rfc-editor.org/rfc/rfc9261#section-4" class="relref">Section 4</a> of [<a href="#EXPORTED-AUTH" class="cite xref">EXPORTED-AUTH</a>]</span>.<a href="#section-3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-3.2">
            <p id="section-3.1-3.2.1">When sent in <code>EncryptedExtensions</code>, the "extension_data" field, <span class="bcp14">MUST</span> be empty or contain a <code>ClientCertificateRequest</code> structure, also defined in <span><a href="https://rfc-editor.org/rfc/rfc9261#section-4" class="relref">Section 4</a> of [<a href="#EXPORTED-AUTH" class="cite xref">EXPORTED-AUTH</a>]</span>.<a href="#section-3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-4">If "extension_data" field is not empty, it is encoded as follows:<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<span id="name-optional-extension_data-of-"></span><figure id="figure-1">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-3.1-5.1">
<pre>
struct {
    select (Handshake.msg_type) {
        case client_hello:         CertificateRequest;
        case encrypted_extensions: ClientCertificateRequest;
    }
} CertificateUpdateRequestExtension;
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-optional-extension_data-of-" class="selfRef">Optional extension_data of certificate_update_request extension</a>
          </figcaption></figure>
<p id="section-3.1-6">The semantics of the extension are as follows:<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-7.1">
            <p id="section-3.1-7.1.1">If the extension is omitted, the sender indicates that it does not support receiving or sending certificate updates.<a href="#section-3.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-7.2">
            <p id="section-3.1-7.2.1">If the extension is present with a zero-length extension_data, the sender indicates that it does not wish to receive certificate updates, but may provide a <code>CertificateUpdate</code> message later in the session if the peer supplied an authenticator request.<a href="#section-3.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-7.3">
            <p id="section-3.1-7.3.1">If the extension is present with a non-empty "extension_data" field, the sender indicates support for certificate updates and provides an authenticator request that the peer may use to generate an exported authenticator in <code>CertificateUpdate</code> message. The <code>extensions</code> list inside the authenticator request <span class="bcp14">MUST</span> be empty.<a href="#section-3.1-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="handling-malformed-extension-data">
<section id="section-3.2">
        <h3 id="name-handling-malformed-extensio">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-handling-malformed-extensio" class="section-name selfRef">Handling Malformed Extension Data</a>
        </h3>
<p id="section-3.2-1">If an endpoint receives a <code>certificate_update_request</code> extension with a non-empty "extension_data" field that cannot be parsed as a valid <code>CertificateRequest</code> (when received in <code>ClientHello</code>) or <code>ClientCertificateRequest</code> (when received in <code>EncryptedExtensions</code>) with empty authenticator request <code>extensions</code>, it <span class="bcp14">MUST</span> abort the handshake with an <code>illegal_parameter</code> alert.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Endpoints <span class="bcp14">MUST NOT</span> attempt to interpret or store a malformed authenticator request. The extension is either valid and usable or invalid and fatal to the handshake.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="certificate-update">
<section id="section-4">
      <h2 id="name-certificate-update">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-certificate-update" class="section-name selfRef">Certificate Update</a>
      </h2>
<p id="section-4-1">Once the the handshake has completed and a peer has provided an authenticator request the other endpoint may send a certificate update using the <code>CertificateUpdate</code> handshake message.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The <code>CertificateUpdate</code> message carries a single Exported Authenticator, constructed using the previously received authenticator request. Authenticator requests are single-use and <span class="bcp14">MUST NOT</span> be reused for multiple updates.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The message is structured as follows:<a href="#section-4-3" class="pilcrow">¶</a></p>
<span id="name-certificateupdate-message"></span><figure id="figure-2">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-4-4.1">
<pre>
struct {
    opaque authenticator;
} CertificateUpdate;
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-certificateupdate-message" class="selfRef">CertificateUpdate message</a>
        </figcaption></figure>
<p id="section-4-5">Embedded authenticator is defined in <span><a href="https://rfc-editor.org/rfc/rfc9261#section-5.2.4" class="relref">Section 5.2.4</a> of [<a href="#EXPORTED-AUTH" class="cite xref">EXPORTED-AUTH</a>]</span> as a concantenation of serialized Certificate, CertificateVerify and Finished messages.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="authenticators-requirements">
<section id="section-4.1">
        <h3 id="name-requirements-for-authentica">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-requirements-for-authentica" class="section-name selfRef">Requirements for Authenticators</a>
        </h3>
<p id="section-4.1-1">The Exported Authenticator carried in a <code>CertificateUpdate</code> message <span class="bcp14">MUST</span> meet the following requirements:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">The subject field of the certificate <span class="bcp14">MUST</span> match exactly with the certificate originally presented by the sender during the handshake.<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">All extensions present in the original certificate <span class="bcp14">MUST</span> also be present in the updated certificate with identical values.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">Updated certificate <span class="bcp14">MUST NOT</span> contain any extensions that are not present in the original certificate.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.4">
            <p id="section-4.1-2.4.1">The public key <span class="bcp14">MAY</span> differ from the original, but the public key algorithm and key length <span class="bcp14">MUST</span> match those of the original certificate.<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.5">
            <p id="section-4.1-2.5.1">The issuer of the updated certificate <span class="bcp14">MUST</span> be the same as the issuer of the original certificate.<a href="#section-4.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.6">
            <p id="section-4.1-2.6.1">The <code>SignatureScheme</code> used in the <code>CertificateVerify</code> message of the Exported Authenticator <span class="bcp14">MUST</span> be the same as the one used in the sender’s original handshake authentication.<a href="#section-4.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-2.7">
            <p id="section-4.1-2.7.1">The certificate provided in the <code>CertificateUpdate</code> message <span class="bcp14">MUST NOT</span> have been used previously by the sender during the current TLS session.<a href="#section-4.1-2.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">These constraints ensure that the authenticator represents the same logical identity and cryptographic profile as the original authentication, while ensuring freshness and preventing redundant certificate reuse. A peer that receives a <code>CertificateUpdate</code> containing a certificate or signature that does not meet these requirements <span class="bcp14">MUST</span> terminate the connection with an <code>illegal_parameter</code> alert.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sending-and-receiving-certificate-updates">
<section id="section-4.2">
        <h3 id="name-sending-and-receiving-certi">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-sending-and-receiving-certi" class="section-name selfRef">Sending and Receiving Certificate Updates</a>
        </h3>
<p id="section-4.2-1">A <code>CertificateUpdate</code> message <span class="bcp14">MAY</span> be sent by either endpoint only after the handshake has completed, specifically after the sender has sent and received the <code>Finished</code> message. The message <span class="bcp14">MUST NOT</span> be sent during the handshake or before the authentication block is complete.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">A <code>CertificateUpdate</code> message <span class="bcp14">MUST NOT</span> be sent unless a valid authenticator request has been received from the peer and has not yet been used. Each authenticator request is single-use and <span class="bcp14">MUST NOT</span> be reused across multiple updates.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">In addition, a client <span class="bcp14">MUST NOT</span> send a <code>CertificateUpdate</code> unless it previously authenticated with a certificate during the handshake or via TLS 1.3 post-handshake authentication <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.6.2" class="relref">Section 4.6.2</a> of [<a href="#TLS" class="cite xref">TLS</a>]</span>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">If any of the above conditions are violated, the recipient <span class="bcp14">MUST</span> terminate the connection with an <code>unexpected_message</code> alert.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">The message carries a single Exported Authenticator, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9261#section-5.2.4" class="relref">Section 5.2.4</a> of [<a href="#EXPORTED-AUTH" class="cite xref">EXPORTED-AUTH</a>]</span>, in the authenticator field. If the authenticator is empty (i.e., it does not contain a <code>Certificate</code>), the peer <span class="bcp14">MUST</span> terminate the connection with an <code>illegal_parameter</code> alert.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">Upon receiving a valid <code>CertificateUpdate</code>, the peer <span class="bcp14">MUST</span> validate the Exported Authenticator according to <span>[<a href="#EXPORTED-AUTH" class="cite xref">EXPORTED-AUTH</a>]</span> and <a href="#authenticators-requirements" class="auto internal xref">Section 4.1</a> of this document. If validation fails, the connection <span class="bcp14">MUST</span> be aborted with an <code>illegal_parameter</code> alert.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">Only one certificate update is permitted per authenticator request. Additional update <span class="bcp14">MUST</span> be provided only in response to a <code>CertificateUpdateRequest</code> message as described in <a href="#additional-authenticator-requests" class="auto internal xref">Section 5</a>.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="additional-authenticator-requests">
<section id="section-5">
      <h2 id="name-additional-authenticator-re">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-additional-authenticator-re" class="section-name selfRef">Additional Authenticator Requests</a>
      </h2>
<p id="section-5-1">Each authenticator request is intended for one-time use, meaning that after an endpoint uses it to generate a <code>CertificateUpdate</code>, it cannot be reused for additional updates. To allow for subsequent certificate updates over the lifetime of a TLS connection, this document defines a new handshake message: <code>CertificateUpdateRequest</code>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The <code>CertificateUpdateRequest</code> message allows an endpoint to send a fresh authenticator request to the peer after a previous <code>CertificateUpdate</code> has been successfully processed.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The message is structured as follows:<a href="#section-5-3" class="pilcrow">¶</a></p>
<span id="name-certificateupdaterequest-me"></span><figure id="figure-3">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-5-4.1">
<pre>
struct {
    opaque authenticator_request;
} CertificateUpdateRequest;
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-certificateupdaterequest-me" class="selfRef">CertificateUpdateRequest message</a>
        </figcaption></figure>
<p id="section-5-5">The authenticator_request field <span class="bcp14">MUST</span> contain either a <code>CertificateRequest</code> or a <code>ClientCertificateRequest</code>, depending on the role of the sender and the direction of certificate update expected:<a href="#section-5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-6.1">
          <p id="section-5-6.1.1">A client sends a <code>CertificateRequest</code> structure (to refresh the server’s certificate).<a href="#section-5-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-6.2">
          <p id="section-5-6.2.1">A server sends a <code>ClientCertificateRequest</code> structure (to refresh the client’s certificate).<a href="#section-5-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-7">The structure and encoding of these fields are identical to the formats defined in <span><a href="https://rfc-editor.org/rfc/rfc9261#section-4" class="relref">Section 4</a> of [<a href="#EXPORTED-AUTH" class="cite xref">EXPORTED-AUTH</a>]</span>. The <code>extensions</code> of the authenticator request <span class="bcp14">MUST</span> be empty.<a href="#section-5-7" class="pilcrow">¶</a></p>
<div id="sending-and-receiving-certificateupdaterequest">
<section id="section-5.1">
        <h3 id="name-sending-and-receiving-certif">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-sending-and-receiving-certif" class="section-name selfRef">Sending and Receiving CertificateUpdateRequest</a>
        </h3>
<p id="section-5.1-1">A <code>CertificateUpdateRequest</code> message <span class="bcp14">MAY</span> be sent at any time after processing a valid <code>CertificateUpdate</code> from the peer. An endpoint <span class="bcp14">MUST NOT</span> send a <code>CertificateUpdateRequest</code> unless it has received and verified a <code>CertificateUpdate</code> using the previous authenticator request. The endpoint <span class="bcp14">MUST</span> wait for the peer to complete a <code>CertificateUpdate</code> using the outstanding request before sending a new one.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Upon receiving a <code>CertificateUpdateRequest</code>, the peer <span class="bcp14">MUST</span> validate that the message contains a well-formed <code>CertificateRequest</code> or <code>ClientCertificateRequest</code>, depending on the sender’s role. If the message is malformed, the authenticator request cannot be parsed or the authenticator request contains extensions, the connection <span class="bcp14">MUST</span> be terminated with an <code>illegal_parameter</code> alert.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="applicability-to-quic">
<section id="section-6">
      <h2 id="name-applicability-to-quic">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-applicability-to-quic" class="section-name selfRef">Applicability to QUIC</a>
      </h2>
<p id="section-6-1">This specification is applicable to the <span>[<a href="#QUIC" class="cite xref">QUIC</a>]</span> protocol, which uses TLS 1.3 for connection security as described in <span>[<a href="#QUIC-TLS" class="cite xref">QUIC-TLS</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Endpoints implementing this specification over QUIC <span class="bcp14">MUST</span> encapsulate <code>CertificateUpdate</code> and <code>CertificateUpdateRequest</code> handshake messages within CRYPTO frames, consistent with the general treatment of TLS messages in QUIC.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">All other requirements defined in this document, including handshake process, message sequences, validation procedures, and error handling, apply equally to QUIC deployments. A QUIC connection <span class="bcp14">MUST</span> treat protocol violations (such as sending a <code>CertificateUpdate</code> before the handshake completes) as connection errors of type <code>CRYPTO_ERROR</code>, using an appropriate alert code such as <code>illegal_parameter</code> or <code>unexpected_message</code> mapped as defined in <span><a href="https://rfc-editor.org/rfc/rfc9000#section-20.1" class="relref">Section 20.1</a> of [<a href="#QUIC" class="cite xref">QUIC</a>]</span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The certificate update mechanism defined in this document is compatible with QUIC as it does not introduce changes to the peer's identity.<a href="#section-6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="applicability-to-dtls">
<section id="section-7">
      <h2 id="name-applicability-to-dtls">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-applicability-to-dtls" class="section-name selfRef">Applicability to DTLS</a>
      </h2>
<p id="section-7-1">This specification is also applicable to DTLS 1.3 <span>[<a href="#DTLS" class="cite xref">DTLS</a>]</span>. The <code>CertificateUpdate</code> and <code>CertificateUpdateRequest</code> messages are handshake messages and are subject to DTLS built-in support for sequencing, fragmentation, retransmission, and replay detection, as specified in <span>[<a href="#DTLS" class="cite xref">DTLS</a>]</span>. No additional protection mechanisms are required beyond the normal DTLS handshake processing.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">This mechanism relies on the security properties of <span>[<a href="#TLS" class="cite xref">TLS</a>]</span> and Exported Authenticators <span>[<a href="#EXPORTED-AUTH" class="cite xref">EXPORTED-AUTH</a>]</span>. It introduces additional opportunities for certificate-based authentication after the initial handshake and requires careful handling to avoid introducing vulnerabilities.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="identity-continuity">
<section id="section-8.1">
        <h3 id="name-identity-continuity">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-identity-continuity" class="section-name selfRef">Identity Continuity</a>
        </h3>
<p id="section-8.1-1">The requirements on updated certificates and signature algorithms ensure that the logical identity authenticated during the handshake remains consistent after a certificate refresh. Endpoints <span class="bcp14">MUST</span> enforce the constraints described in <a href="#authenticators-requirements" class="auto internal xref">Section 4.1</a> to prevent identity swapping or privilege escalation.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Updated certificates <span class="bcp14">MUST NOT</span> introduce new names, extensions, or capabilities beyond those present in the original certificate. Failure to enforce these constraints could allow an attacker to impersonate a different entity within the same connection.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay-prevention">
<section id="section-8.2">
        <h3 id="name-replay-prevention">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-replay-prevention" class="section-name selfRef">Replay Prevention</a>
        </h3>
<p id="section-8.2-1">Each authenticator request <span class="bcp14">MUST</span> be used exactly once to prevent replay attacks. Exported Authenticators inherently bind to the session and context, but replaying an old <code>CertificateUpdate</code> against a reused authenticator request could allow undetected identity reuse.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Endpoints <span class="bcp14">MUST</span> discard authenticator requests after a successful <code>CertificateUpdate</code> and <span class="bcp14">MUST</span> validate that each certificate update corresponds uniquely to the most recent authenticator request received.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application-layer-implications">
<section id="section-8.3">
        <h3 id="name-application-layer-implicati">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-application-layer-implicati" class="section-name selfRef">Application-Layer Implications</a>
        </h3>
<p id="section-8.3-1">Applications that rely on peer certificate properties for access control decisions <span class="bcp14">MAY</span> reevaluate those decisions after a certificate update if needed. However, because the updated certificate is required to maintain the same identity, such re-validation is typically unnecessary for applications that rely only on the peer's authenticated identity. If the updated certificate does not match the identity validated during the TLS handshake, the TLS stack <span class="bcp14">MUST</span> terminate the connection.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document registers a new TLS extension and two new TLS handshake message types, as described below.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="tls-extension">
<section id="section-9.1">
        <h3 id="name-tls-extension">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-tls-extension" class="section-name selfRef">TLS Extension</a>
        </h3>
<p id="section-9.1-1">IANA is requested to add the following entry to the "TLS ExtensionType Values" registry:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-2.1">
            <p id="section-9.1-2.1.1">The value is TBD<a href="#section-9.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.2">
            <p id="section-9.1-2.2.1">The Extension Name is certificate_update_request<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.3">
            <p id="section-9.1-2.3.1">The TLS 1.3 value is CH, EE<a href="#section-9.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.4">
            <p id="section-9.1-2.4.1">The DTLS-Only value is N<a href="#section-9.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.5">
            <p id="section-9.1-2.5.1">The Recommended value is Y<a href="#section-9.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.6">
            <p id="section-9.1-2.6.1">The Reference is this document<a href="#section-9.1-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="tls-handshake-message-types">
<section id="section-9.2">
        <h3 id="name-tls-handshake-message-types">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-tls-handshake-message-types" class="section-name selfRef">TLS Handshake Message Types</a>
        </h3>
<p id="section-9.2-1">IANA is requested to add the following entries to the "TLS HandshakeType" registry.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2"><code>CertificateUpdate</code> message:<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-3.1">
            <p id="section-9.2-3.1.1">The value is TBD1<a href="#section-9.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-3.2">
            <p id="section-9.2-3.2.1">The description is certificate_update<a href="#section-9.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-3.3">
            <p id="section-9.2-3.3.1">The DTLS-OK is Y<a href="#section-9.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-3.4">
            <p id="section-9.2-3.4.1">The Reference is this document<a href="#section-9.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-3.5">
            <p id="section-9.2-3.5.1">The Comment section is empty<a href="#section-9.2-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.2-4"><code>CertificateUpdateRequest</code> message:<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-5.1">
            <p id="section-9.2-5.1.1">The value is TBD2<a href="#section-9.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-5.2">
            <p id="section-9.2-5.2.1">The description is certificate_update_request<a href="#section-9.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-5.3">
            <p id="section-9.2-5.3.1">The DTLS-OK is Y<a href="#section-9.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-5.4">
            <p id="section-9.2-5.4.1">The Reference is this document<a href="#section-9.2-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.2-5.5">
            <p id="section-9.2-5.5.1">The Comment section is empty<a href="#section-9.2-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="DTLS">[DTLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EXPORTED-AUTH">[EXPORTED-AUTH]</dt>
        <dd>
<span class="refAuthor">Sullivan, N.</span>, <span class="refTitle">"Exported Authenticators in TLS"</span>, <span class="seriesInfo">RFC 9261</span>, <span class="seriesInfo">DOI 10.17487/RFC9261</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9261">https://www.rfc-editor.org/rfc/rfc9261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS">[TLS]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="HTTP2-TLS13">[HTTP2-TLS13]</dt>
        <dd>
<span class="refAuthor">Benjamin, D.</span>, <span class="refTitle">"Using TLS 1.3 with HTTP/2"</span>, <span class="seriesInfo">RFC 8740</span>, <span class="seriesInfo">DOI 10.17487/RFC8740</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8740">https://www.rfc-editor.org/rfc/rfc8740</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC">[QUIC]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="QUIC-TLS">[QUIC-TLS]</dt>
      <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9001">https://www.rfc-editor.org/rfc/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yaroslav Rosomakho</span></div>
<div dir="auto" class="left"><span class="org">Zscaler</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:yrosomakho@zscaler.com" class="email">yrosomakho@zscaler.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kondtir@gmail.com" class="email">kondtir@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
